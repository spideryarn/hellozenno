{% extends "base_with_tailwind.jinja" %}

{# Set the Vite entry point for this page #}
{% set vite_entry = 'lemma-entry' %}

{% block title %}
{{ lemma_metadata.lemma }} in {{ target_language_name }} (lemma) - Hello Zenno
{% endblock %}

{% block breadcrumbs %}
    » <a href="{{ url_for('views.languages') }}">Languages</a>
    » <a href="{{ url_for('sourcedir_views.sourcedirs_for_language', target_language_code=target_language_code) }}">{{ target_language_name }}</a>
    » <a href="{{ url_for('lemma_views.lemmas_list', target_language_code=target_language_code) }}">Lemmas</a>
    » {{ lemma_metadata.lemma }}
{% endblock breadcrumbs %}

{% block content %}
<div class="tw-container-prose">
    {% if metadata %}
    <div class="tw-metadata">
        <p>Created: <span>{{ metadata.created_at.strftime('%Y-%m-%d %H:%M:%S') }}</span></p>
        <p>Updated: <span>{{ metadata.updated_at.strftime('%Y-%m-%d %H:%M:%S') }}</span></p>
    </div>
    {% endif %}

    <h1>{{ lemma_metadata.lemma }}</h1>
    
    <div class="tw-action-group">
        <form action="{{ url_for('lemma_views.delete_lemma', target_language_code=target_language_code, lemma=lemma_metadata.lemma) }}" 
              method="POST" 
              onsubmit="return confirm('Are you sure you want to delete this lemma? All associated wordforms will also be deleted. This action cannot be undone.');">
            <button type="submit" class="tw-btn tw-btn-danger">Delete lemma</button>
        </form>
    </div>
    
    <div class="tw-content-section">
        <div class="tw-grid tw-grid-cols-2 tw-gap-6">
            <div>
                <h2>Basic Information</h2>
                <dl class="tw-space-y-4">
                    <div>
                        <dt class="tw-text-gray-600">Translation</dt>
                        <dd class="tw-text-lg">{{ lemma_metadata.translations|join('; ') if lemma_metadata.translations else 'No translation available' }}</dd>
                    </div>
                    <div>
                        <dt class="tw-text-gray-600">Part of Speech</dt>
                        <dd>{{ lemma_metadata.part_of_speech if lemma_metadata.part_of_speech else 'Not available' }}</dd>
                    </div>
                    <div>
                        <dt class="tw-text-gray-600">Etymology</dt>
                        <dd>{{ lemma_metadata.etymology if lemma_metadata.etymology else 'Not available' }}</dd>
                    </div>
                </dl>
            </div>
            <div>
                <h2>Statistics</h2>
                <dl class="tw-space-y-4">
                    <div>
                        <dt class="tw-text-gray-600">Commonality</dt>
                        <dd>{{ '%.0f'|format(lemma_metadata.commonality|float * 100) if lemma_metadata.commonality else '0' }}%</dd>
                    </div>
                    <div>
                        <dt class="tw-text-gray-600">Guessability</dt>
                        <dd>{{ '%.0f'|format(lemma_metadata.guessability|float * 100) if lemma_metadata.guessability else '0' }}%</dd>
                    </div>
                    <div>
                        <dt class="tw-text-gray-600">Register</dt>
                        <dd>{{ lemma_metadata.register if lemma_metadata.register else 'Not available' }}</dd>
                    </div>
                </dl>
            </div>
        </div>
    </div>

    {% if lemma_metadata.example_usage %}
    <div class="tw-content-section">
        <h2>Example Usage</h2>
        <ul class="tw-list">
            {% for example in lemma_metadata.example_usage %}
            <li class="tw-list-item">
                <a href="{{ url_for('sentence_views.get_sentence', language_code=target_language_code, slug=example.slug) if example.slug else '#' }}" 
                   class="tw-block">
                    <div class="tw-text-lg tw-mb-1">{{ example.phrase }}</div>
                    <div class="tw-text-gray-600">{{ example.translation }}</div>
                </a>
            </li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    {% if lemma_metadata.mnemonics %}
    <div class="tw-content-section">
        <h2>Mnemonics</h2>
        <ul class="tw-list">
            {% for mnemonic in lemma_metadata.mnemonics %}
            <li class="tw-list-item tw-italic">{{ mnemonic }}</li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    {% if lemma_metadata.related_words_phrases_idioms %}
    <div class="tw-content-section">
        <h2>Related Words, Phrases & Idioms</h2>
        <ul class="tw-list">
            {% for related in lemma_metadata.related_words_phrases_idioms %}
            <li class="tw-list-item">
                <div class="tw-font-medium">{{ related.lemma }}</div>
                <div class="tw-text-gray-600">{{ related.translation }}</div>
            </li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    {% if lemma_metadata.synonyms or lemma_metadata.antonyms %}
    <div class="tw-content-section">
        <div class="tw-grid tw-grid-cols-2 tw-gap-6">
            {% if lemma_metadata.synonyms %}
            <div>
                <h2>Synonyms</h2>
                <ul class="tw-list">
                    {% for synonym in lemma_metadata.synonyms %}
                    <li class="tw-list-item">
                        <div class="tw-font-medium">{{ synonym.lemma }}</div>
                        <div class="tw-text-gray-600">{{ synonym.translation }}</div>
                    </li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}
            
            {% if lemma_metadata.antonyms %}
            <div>
                <h2>Antonyms</h2>
                <ul class="tw-list">
                    {% for antonym in lemma_metadata.antonyms %}
                    <li class="tw-list-item">
                        <div class="tw-font-medium">{{ antonym.lemma }}</div>
                        <div class="tw-text-gray-600">{{ antonym.translation }}</div>
                    </li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}
        </div>
    </div>
    {% endif %}

    {% if lemma_metadata.example_wordforms %}
    <div class="tw-content-section">
        <h2>Example Wordforms</h2>
        <ul class="tw-list">
            {% for form in lemma_metadata.example_wordforms %}
            <li class="tw-list-item">
                <a href="{{ url_for('wordform_views.get_wordform_metadata', target_language_code=target_language_code, wordform=form) }}"
                   class="tw-word-link">
                    {{ form }}
                </a>
            </li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    {% if lemma_metadata.cultural_context %}
    <div class="tw-content-section">
        <h2>Cultural Context</h2>
        <div class="tw-text-content">
            {{ lemma_metadata.cultural_context }}
        </div>
    </div>
    {% endif %}

    {% if lemma_metadata.easily_confused_with %}
    <div class="tw-content-section">
        <h2>Easily Confused With</h2>
        <ul class="tw-list">
            {% for confused in lemma_metadata.easily_confused_with %}
            <li class="tw-list-item">
                <h3>{{ confused.lemma }}</h3>
                <div class="tw-space-y-3">
                    <div>
                        <div class="tw-text-gray-600">Explanation</div>
                        <div>{{ confused.explanation }}</div>
                    </div>
                    <div>
                        <div class="tw-text-gray-600">Example with {{ lemma_metadata.lemma }}</div>
                        <div>{{ confused.example_usage_this_target }}</div>
                    </div>
                    <div>
                        <div class="tw-text-gray-600">Example with {{ confused.lemma }}</div>
                        <div>{{ confused.example_usage_other_target }}</div>
                    </div>
                    {% if confused.notes %}
                    <div>
                        <div class="tw-text-gray-600">Notes</div>
                        <div>{{ confused.notes }}</div>
                    </div>
                    {% endif %}
                    {% if confused.mnemonic %}
                    <div>
                        <div class="tw-text-gray-600">Mnemonic</div>
                        <div class="tw-italic">{{ confused.mnemonic }}</div>
                    </div>
                    {% endif %}
                </div>
            </li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    {% if dict_html %}
    <div class="tw-content-section">
        <h2>Full Dictionary Entry</h2>
        <div class="tw-text-content">
            {{ dict_html | safe }}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
