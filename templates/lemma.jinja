{% extends "base_with_tailwind.jinja" %}

{% block title %}
{{ lemma_metadata.lemma }} in {{ target_language_name }} (lemma) - Hello Zenno
{% endblock %}

{% block breadcrumbs %}
    » <a href="{{ url_for('views.languages') }}">Languages</a>
    » <a href="{{ url_for('sourcedir_views.sourcedirs_for_language', target_language_code=target_language_code) }}">{{ target_language_name }}</a>
    » <a href="{{ url_for('lemma_views.lemmas_list', target_language_code=target_language_code) }}">Lemmas</a>
    » {{ lemma_metadata.lemma }}
{% endblock breadcrumbs %}

{% block content %}
<div class="tw-container-wide">
    {% if metadata %}
    <div class="tw-metadata">
        <p>Created: <span>{{ metadata.created_at.strftime('%Y-%m-%d %H:%M:%S') }}</span></p>
        <p>Updated: <span>{{ metadata.updated_at.strftime('%Y-%m-%d %H:%M:%S') }}</span></p>
    </div>
    {% endif %}

    <h1>{{ lemma_metadata.lemma }}</h1>
    
    <div class="tw-action-group">
        <form action="{{ url_for('lemma_views.delete_lemma', target_language_code=target_language_code, lemma=lemma_metadata.lemma) }}" 
              method="POST" 
              onsubmit="return confirm('Are you sure you want to delete this lemma? All associated wordforms will also be deleted. This action cannot be undone.');">
            <button type="submit" class="tw-btn tw-btn-danger">Delete lemma</button>
        </form>
    </div>
    
    <div class="tw-content-section">
        <h2 class="tw-content-section-title">Overview</h2>
        <div class="tw-content-grid">
            <div>
                <h3>Basic Information</h3>
                <dl>
                    <div>
                        <dt>Translation</dt>
                        <dd class="tw-text-lg">{{ lemma_metadata.translations|join('; ') if lemma_metadata.translations else 'No translation available' }}</dd>
                    </div>
                    <div>
                        <dt>Part of Speech</dt>
                        <dd>{{ lemma_metadata.part_of_speech if lemma_metadata.part_of_speech else 'Not available' }}</dd>
                    </div>
                    <div>
                        <dt>Etymology</dt>
                        <dd>{{ lemma_metadata.etymology if lemma_metadata.etymology else 'Not available' }}</dd>
                    </div>
                </dl>
            </div>
            <div>
                <h3>Statistics</h3>
                <dl>
                    <div>
                        <dt>Commonality</dt>
                        <dd>{{ '%.0f'|format(lemma_metadata.commonality|float * 100) if lemma_metadata.commonality else '0' }}%</dd>
                    </div>
                    <div>
                        <dt>Guessability</dt>
                        <dd>{{ '%.0f'|format(lemma_metadata.guessability|float * 100) if lemma_metadata.guessability else '0' }}%</dd>
                    </div>
                    <div>
                        <dt>Register</dt>
                        <dd>{{ lemma_metadata.register if lemma_metadata.register else 'Not available' }}</dd>
                    </div>
                </dl>
            </div>
            {% if lemma_metadata.cultural_context %}
            <div>
                <h3>Cultural Context</h3>
                <div class="tw-text-content">
                    {{ lemma_metadata.cultural_context }}
                </div>
            </div>
            {% endif %}
        </div>
    </div>

    <div class="tw-content-grid-wide">
        {% if lemma_metadata.example_usage %}
        <div class="tw-content-section">
            <h2 class="tw-content-section-title">Example Usage</h2>
            <ul class="tw-list">
                {% for example in lemma_metadata.example_usage %}
                <li class="tw-list-item">
                    <a href="{{ url_for('sentence_views.get_sentence', language_code=target_language_code, slug=example.slug) if example.slug else '#' }}" 
                       class="tw-block">
                        <div class="tw-text-lg tw-mb-2">{{ example.phrase }}</div>
                        <div class="tw-text-gray-600">{{ example.translation }}</div>
                    </a>
                </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        {% if lemma_metadata.mnemonics %}
        <div class="tw-content-section">
            <h2 class="tw-content-section-title">Mnemonics</h2>
            <ul class="tw-list">
                {% for mnemonic in lemma_metadata.mnemonics %}
                <li class="tw-list-item tw-italic">{{ mnemonic }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        {% if lemma_metadata.example_wordforms %}
        <div class="tw-content-section">
            <h2 class="tw-content-section-title">Example Wordforms</h2>
            <ul class="tw-list-wide">
                {% for form in lemma_metadata.example_wordforms %}
                <li class="tw-list-item">
                    <a href="{{ url_for('wordform_views.get_wordform_metadata', target_language_code=target_language_code, wordform=form) }}"
                       class="tw-word-link">
                        {{ form }}
                    </a>
                </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        {% if lemma_metadata.related_words_phrases_idioms %}
        <div class="tw-content-section">
            <h2 class="tw-content-section-title">Related Words, Phrases & Idioms</h2>
            <ul class="tw-list-wide">
                {% for related in lemma_metadata.related_words_phrases_idioms %}
                <li class="tw-list-item">
                    <div class="tw-font-medium tw-mb-1">{{ related.lemma }}</div>
                    <div class="tw-text-gray-600">{{ related.translation }}</div>
                </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
    </div>

    {% if lemma_metadata.synonyms or lemma_metadata.antonyms %}
    <div class="tw-content-section">
        <h2 class="tw-content-section-title">Related Terms</h2>
        <div class="tw-content-grid">
            {% if lemma_metadata.synonyms %}
            <div>
                <h3>Synonyms</h3>
                <ul class="tw-list">
                    {% for synonym in lemma_metadata.synonyms %}
                    <li class="tw-list-item">
                        <div class="tw-font-medium tw-mb-1">{{ synonym.lemma }}</div>
                        <div class="tw-text-gray-600">{{ synonym.translation }}</div>
                    </li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}
            
            {% if lemma_metadata.antonyms %}
            <div>
                <h3>Antonyms</h3>
                <ul class="tw-list">
                    {% for antonym in lemma_metadata.antonyms %}
                    <li class="tw-list-item">
                        <div class="tw-font-medium tw-mb-1">{{ antonym.lemma }}</div>
                        <div class="tw-text-gray-600">{{ antonym.translation }}</div>
                    </li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}
        </div>
    </div>
    {% endif %}

    {% if lemma_metadata.easily_confused_with %}
    <div class="tw-content-section">
        <h2 class="tw-content-section-title">Easily Confused With</h2>
        <ul class="tw-list-wide">
            {% for confused in lemma_metadata.easily_confused_with %}
            <li class="tw-list-item">
                <h3>{{ confused.lemma }}</h3>
                <div class="tw-space-y-4">
                    <div>
                        <dt>Explanation</dt>
                        <dd>{{ confused.explanation }}</dd>
                    </div>
                    <div>
                        <dt>Example with {{ lemma_metadata.lemma }}</dt>
                        <dd>{{ confused.example_usage_this_target }}</dd>
                    </div>
                    <div>
                        <dt>Example with {{ confused.lemma }}</dt>
                        <dd>{{ confused.example_usage_other_target }}</dd>
                    </div>
                    {% if confused.notes %}
                    <div>
                        <dt>Notes</dt>
                        <dd>{{ confused.notes }}</dd>
                    </div>
                    {% endif %}
                    {% if confused.mnemonic %}
                    <div>
                        <dt>Mnemonic</dt>
                        <dd class="tw-italic">{{ confused.mnemonic }}</dd>
                    </div>
                    {% endif %}
                </div>
            </li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    {% if dict_html %}
    <div class="tw-content-section">
        <h2 class="tw-content-section-title">Full Dictionary Entry</h2>
        <div class="tw-text-content">
            {{ dict_html | safe }}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
