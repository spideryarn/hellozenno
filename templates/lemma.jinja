{% extends "base.jinja" %}

{% block title %}
{{ lemma_metadata.lemma }} in {{ target_language_name }} (lemma) - Hello Zenno
{% endblock %}

{% block breadcrumbs %}
    » <a href="{{ url_for('views.languages') }}">Languages</a>
    » <a href="{{ url_for('sourcedir_views.sourcedirs_for_language', target_language_code=target_language_code) }}">{{ target_language_name }}</a>
    » <a href="{{ url_for('lemma_views.lemmas_list', target_language_code=target_language_code) }}">Lemmas</a>
    » {{ lemma_metadata.lemma }}
{% endblock breadcrumbs %}

{% block content %}
<div class="container">
    <div class="lemma-header">
        <h1>{{ lemma_metadata.lemma }}</h1>
        {% if metadata %}
        <div class="metadata-display">
            <p>Created: {{ metadata.created_at.strftime('%Y-%m-%d %H:%M:%S') }}</p>
            <p>Updated: {{ metadata.updated_at.strftime('%Y-%m-%d %H:%M:%S') }}</p>
        </div>
        {% endif %}

        <div class="button-group">
            <form action="{{ url_for('lemma_views.delete_lemma', target_language_code=target_language_code, lemma=lemma_metadata.lemma) }}" 
                  method="POST" 
                  onsubmit="return confirm('Are you sure you want to delete this lemma? All associated wordforms will also be deleted. This action cannot be undone.');">
                <button type="submit" class="button delete-btn">Delete lemma</button>
            </form>
        </div>
    </div>

    <div class="lemma-content">
        <div class="overview-section">
            <div class="basic-info">
                <h2>Basic Information</h2>
                <dl>
                    <div>
                        <dt>Translation</dt>
                        <dd>{{ lemma_metadata.translations|join('; ') if lemma_metadata.translations else 'No translation available' }}</dd>
                    </div>
                    <div>
                        <dt>Part of Speech</dt>
                        <dd>{{ lemma_metadata.part_of_speech if lemma_metadata.part_of_speech else 'Not available' }}</dd>
                    </div>
                    <div>
                        <dt>Etymology</dt>
                        <dd>{{ lemma_metadata.etymology if lemma_metadata.etymology else 'Not available' }}</dd>
                    </div>
                </dl>
            </div>

            <div class="stats-info">
                <h2>Statistics</h2>
                <dl>
                    <div>
                        <dt>Commonality</dt>
                        <dd>{{ '%.0f'|format(lemma_metadata.commonality|float * 100) if lemma_metadata.commonality else '0' }}%</dd>
                    </div>
                    <div>
                        <dt>Guessability</dt>
                        <dd>{{ '%.0f'|format(lemma_metadata.guessability|float * 100) if lemma_metadata.guessability else '0' }}%</dd>
                    </div>
                    <div>
                        <dt>Register</dt>
                        <dd>{{ lemma_metadata.register if lemma_metadata.register else 'Not available' }}</dd>
                    </div>
                </dl>
            </div>

            {% if lemma_metadata.cultural_context %}
            <div class="cultural-context">
                <h2>Cultural Context</h2>
                <div class="text-content">
                    {{ lemma_metadata.cultural_context }}
                </div>
            </div>
            {% endif %}
        </div>

        {% if lemma_metadata.example_usage %}
        <div class="section">
            <h2>Example Usage</h2>
            <ul class="phrases-list">
                {% for example in lemma_metadata.example_usage %}
                <li class="phrase-item">
                    <a href="{{ url_for('sentence_views.get_sentence', language_code=target_language_code, slug=example.slug) if example.slug else '#' }}" 
                       class="phrase-link">
                        <div class="example-text">{{ example.phrase }}</div>
                        <div class="example-translation">{{ example.translation }}</div>
                    </a>
                </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        {% if lemma_metadata.mnemonics %}
        <div class="section">
            <h2>Mnemonics</h2>
            <ul class="phrases-list">
                {% for mnemonic in lemma_metadata.mnemonics %}
                <li class="phrase-item mnemonic">{{ mnemonic }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        {% if lemma_metadata.example_wordforms %}
        <div class="section">
            <h2>Example Wordforms</h2>
            <ul class="phrases-list">
                {% for form in lemma_metadata.example_wordforms %}
                <li class="phrase-item">
                    <a href="{{ url_for('wordform_views.get_wordform_metadata', target_language_code=target_language_code, wordform=form) }}"
                       class="word-link">
                        {{ form }}
                    </a>
                </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        {% if lemma_metadata.related_words_phrases_idioms %}
        <div class="section">
            <h2>Related Words, Phrases & Idioms</h2>
            <ul class="phrases-list">
                {% for related in lemma_metadata.related_words_phrases_idioms %}
                <li class="phrase-item">
                    <div class="related-word">{{ related.lemma }}</div>
                    <div class="related-translation">{{ related.translation }}</div>
                </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        {% if lemma_metadata.synonyms or lemma_metadata.antonyms %}
        <div class="section">
            <h2>Related Terms</h2>
            <div class="related-terms">
                {% if lemma_metadata.synonyms %}
                <div class="synonyms">
                    <h3>Synonyms</h3>
                    <ul class="phrases-list">
                        {% for synonym in lemma_metadata.synonyms %}
                        <li class="phrase-item">
                            <div class="related-word">{{ synonym.lemma }}</div>
                            <div class="related-translation">{{ synonym.translation }}</div>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}
                
                {% if lemma_metadata.antonyms %}
                <div class="antonyms">
                    <h3>Antonyms</h3>
                    <ul class="phrases-list">
                        {% for antonym in lemma_metadata.antonyms %}
                        <li class="phrase-item">
                            <div class="related-word">{{ antonym.lemma }}</div>
                            <div class="related-translation">{{ antonym.translation }}</div>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}
            </div>
        </div>
        {% endif %}

        {% if lemma_metadata.easily_confused_with %}
        <div class="section">
            <h2>Easily Confused With</h2>
            <ul class="confusion-list">
                {% for confused in lemma_metadata.easily_confused_with %}
                <li class="confusion-item">
                    <h3>{{ confused.lemma }}</h3>
                    <div class="confusion-explanation">
                        <dt>Explanation</dt>
                        <dd>{{ confused.explanation }}</dd>
                    </div>
                    <div class="confusion-examples">
                        <div class="example-pair">
                            <dt>Example with {{ lemma_metadata.lemma }}</dt>
                            <dd>{{ confused.example_usage_this_target }}</dd>
                        </div>
                        <div class="example-pair">
                            <dt>Example with {{ confused.lemma }}</dt>
                            <dd>{{ confused.example_usage_other_target }}</dd>
                        </div>
                    </div>
                    {% if confused.notes %}
                    <div class="confusion-notes">
                        <dt>Notes</dt>
                        <dd>{{ confused.notes }}</dd>
                    </div>
                    {% endif %}
                    {% if confused.mnemonic %}
                    <div class="confusion-mnemonic">
                        <dt>Mnemonic</dt>
                        <dd>{{ confused.mnemonic }}</dd>
                    </div>
                    {% endif %}
                </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        {% if dict_html %}
        <div class="section">
            <h2>Full Dictionary Entry</h2>
            <div class="text-content">
                {{ dict_html | safe }}
            </div>
        </div>
        {% endif %}
    </div>
</div>

<style>
.lemma-header {
    margin-bottom: 2rem;
}

.metadata-display {
    color: #666;
    font-size: 0.9rem;
    margin: 1rem 0;
}

.lemma-content {
    max-width: 1000px;
    margin: 0 auto;
}

.overview-section {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
    margin-bottom: 2rem;
}

.basic-info, .stats-info {
    background: white;
    padding: 1.5rem;
    border-radius: 8px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.cultural-context {
    grid-column: 1 / -1;
    background: white;
    padding: 1.5rem;
    border-radius: 8px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.section {
    background: white;
    padding: 1.5rem;
    border-radius: 8px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    margin-bottom: 2rem;
}

.related-terms {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
}

h1 {
    font-size: 2.5rem;
    margin-bottom: 1rem;
}

h2 {
    font-size: 1.5rem;
    margin-bottom: 1rem;
    color: #333;
}

h3 {
    font-size: 1.2rem;
    margin-bottom: 0.75rem;
    color: #444;
}

dt {
    font-weight: 500;
    color: #666;
    margin-bottom: 0.25rem;
}

dd {
    margin-left: 0;
    margin-bottom: 1rem;
}

.example-text {
    font-size: 1.1rem;
    margin-bottom: 0.25rem;
}

.example-translation {
    color: #666;
    font-style: italic;
}

.confusion-item {
    margin-bottom: 2rem;
    padding: 1rem;
    background: #f8f9fa;
    border-radius: 4px;
}

.example-pair {
    margin: 1rem 0;
}

.confusion-explanation,
.confusion-notes,
.confusion-mnemonic {
    margin: 1rem 0;
}
</style>
{% endblock %}
