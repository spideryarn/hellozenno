{% extends "base.jinja" %}
{% set vite_entries = [] %}
{% set svelte_umd_mode = True %}

{% block title %}{{ target_language_name }} Flashcards - Hello Zenno{% endblock %}

{% block breadcrumbs %}
    » <a href="{{ url_for('views.languages') }}">Languages</a>
    » <a href="{{ url_for('sourcedir_views.sourcedirs_for_language', target_language_code=target_language_code) }}">{{ target_language_name }}</a>
    {% if not sourcedir and not sourcefile %}
    » <a href="{{ url_for('sentence_views.sentences_list', language_code=target_language_code) }}">Sentences</a>
    {% endif %}
    {% if sourcedir %}
    » <a href="{{ url_for('sourcedir_views.sourcefiles_for_sourcedir', target_language_code=target_language_code, sourcedir_slug=sourcedir.slug) }}">{{ sourcedir.path }}</a>
    {% endif %}
    {% if sourcefile is not string and sourcefile %}
    » <a href="{{ url_for('sourcedir_views.sourcefiles_for_sourcedir', target_language_code=target_language_code, sourcedir_slug=sourcefile.sourcedir.slug) }}">{{ sourcefile.sourcedir.path }}</a>
    » <a href="{{ url_for('sourcefile_views.inspect_sourcefile', target_language_code=target_language_code, sourcedir_slug=sourcefile.sourcedir.slug, sourcefile_slug=sourcefile.slug) }}">{{ sourcefile.filename }}</a>
    {% endif %}
    » Flashcards
{% endblock breadcrumbs %}

{% block content %}
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card">
                <div class="card-body text-center">
                    <h1 class="mb-4">{{ target_language_name }} Flashcards</h1>
                    
                    <p class="lead">Practice with sentence flashcards to improve your {{ target_language_name }} skills.</p>
                    
                    <script>
                      // Mount the component with the proper props after page loads
                      document.addEventListener("DOMContentLoaded", function() {
                        console.log("HzComponents:", HzComponents);
                        const FlashcardLanding = HzComponents.default.flashcardlanding;
                        
                        // Instantiate the component
                        FlashcardLanding(document.getElementById('flashcard-landing'), {
                          targetLanguageCode: '{{ target_language_code }}',
                          targetLanguageName: '{{ target_language_name }}',
                          sourcefile: {% if sourcefile %}'{{ sourcefile.slug }}'{% else %}null{% endif %},
                          sourcedir: {% if sourcedir %}'{{ sourcedir.slug }}'{% else %}null{% endif %},
                          lemmaCount: {% if lemma_count %}{{ lemma_count }}{% else %}null{% endif %}
                        });
                        
                        // Add global keyboard shortcut for ENTER
                        const startUrl = "/{{ target_language_code }}/flashcards/random{% if sourcefile %}?sourcefile={{ sourcefile.slug }}{% elif sourcedir %}?sourcedir={{ sourcedir.slug }}{% endif %}";
                        
                        document.addEventListener("keydown", function(event) {
                          // Only trigger if no input element is focused
                          if (event.key === "Enter" && 
                              !(document.activeElement instanceof HTMLInputElement) && 
                              !(document.activeElement instanceof HTMLTextAreaElement)) {
                            window.location.href = startUrl;
                          }
                        });
                      });
                    </script>
                    
                    <div id="flashcard-landing"></div>
                    
                    {% if lemma_count %}
                    <div class="mt-3">
                        <p class="text-muted">
                            Practice with {{ lemma_count }} words
                            {% if sourcedir %}from directory {{ sourcedir.path }}{% endif %}
                            {% if sourcefile %}from file {{ sourcefile.filename }}{% endif %}
                        </p>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}